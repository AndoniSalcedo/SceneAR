<html>
	<head>
		<meta charset="UTF-8" />
		<title>Escena AR</title>
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<script src="https://aframe.io/releases/1.4.1/aframe.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.1/dist/mindar-image-aframe.prod.js"></script>

		<script>
			AFRAME.registerComponent("occlusion", {
				schema: {
					type: "boolean",
					default: true,
				},

				init: function () {
					this.setOcclusion(this.data);
				},

				update: function () {
					console.log(this.data);
					this.setOcclusion(this.data);
				},

				setOcclusion: function (val) {
					const material = new THREE.MeshStandardMaterial({
						colorWrite: !val,
						color: 0xff0000,
					});

					this.el.object3D.traverse((obj) => {
						obj.material = material;
					});
				},
			});
		</script>
	</head>
	<body>
		<a-scene
			mindar-image="imageTargetSrc: ./beer.mind;"
			vr-mode-ui="enabled: false"
			device-orientation-permission-ui="enabled: false"
		>
			<a-assets>
				<a-asset-item
					src="./assets/duck/rubber_duck_toy_1k.gltf"
					id="duck"
				/>
			</a-assets>
			<a-assets>
				<a-asset-item
					src="./assets/jar/jar/ceramic_vase_02_1k.gltf"
					id="jar"
				/>
			</a-assets>
			<a-camera
				position="0 0 0"
				look-controls="enabled: false"
			></a-camera>

			<a-entity mindar-image-target="targetIndex: 0">
				<a-entity
					id="occlusion"
					position="0 0 1"
					scale="1 1 1"
				>
					<a-box
						position="0 0.375 0"
						height="0.75"
						width="0.75"
						depth="0.75"
						material="color:orange;opacity:0.5"
						geometry
					></a-box>
				</a-entity>
      			<a-entity
      			  id="horse"
      			  gltf-model="#duck"
      			  position="0 0 0"
				  rotation="0 90 0"
				  scale="1 1 1"
      			>

				<!-- <a-entity
				  id="jar"
				  gltf-model="#jar"
				  rotation="0 180 0"
				  position="0 0 1.5"
				  scale="1 1 1"
				> -->
			</a-entity>
		</a-scene>
	</body>
</html>
